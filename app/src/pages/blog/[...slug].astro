---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import Sidebar from '../../components/Sidebar.astro'; // Import Sidebar

export async function getStaticPaths() {
	const posts = await getCollection('blog');
	return posts.map((post) => ({
		params: { slug: post.slug },
		props: post,
	}));
}

const post = Astro.props;
const { Content } = await post.render();
---

<Layout title={post.data.title}>
    
    <nav class="navbar">
        <div class="nav-container container">
            <a href="/" class="nav-logo">
                <span class="logo-text">Nasticks</span>
                <span class="logo-cursor">_</span>
            </a>
            <ul class="nav-menu">
                <li><a href="/#about" class="nav-link">À Propos</a></li>
                <li><a href="/#skills" class="nav-link">Compétences</a></li>
                <li><a href="/#projects" class="nav-link">Projets</a></li>
                <li><a href="/blog" class="nav-link active">Blog</a></li>
                <li><a href="/#contact" class="nav-link btn-primary" style="padding: 0.5rem 1rem; color: #020617;">Contact</a></li>
            </ul>
        </div>
    </nav>

    <div class="split-wrapper">
        
        <Sidebar />

        <main class="right-scroll">
            
            <article style="max-width: 800px;">
                <a href="/blog" class="btn btn-secondary" style="margin-bottom: 2rem; font-size: 0.8rem; display: inline-flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-arrow-left"></i> Retour
                </a>

                <header style="margin-bottom: 3rem; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 2rem;">
                    <h1 class="hero-title" style="font-size: 2.5rem; margin-bottom: 1rem;">{post.data.title}</h1>
                    <div style="color: var(--text-muted); font-family: var(--font-mono); font-size: 0.9rem;">
                        <i class="far fa-calendar"></i> {post.data.pubDate.toLocaleDateString()} 
                        &nbsp;•&nbsp; 
                        <i class="far fa-user"></i> {post.data.author}
                    </div>
                </header>

                <div class="article-content">
                    <Content />
                </div>
            </article>

            <footer style="margin-top: 4rem; padding-top: 2rem; border-top: 1px solid rgba(255,255,255,0.05); color: #64748b; font-size: 0.85rem;">
                <p>&copy; 2025 Nasticks. Infrastructure as Code & Design.</p>
            </footer>

        </main>
    </div>
</Layout>

<style is:global>
    .article-content { color: var(--text-main); line-height: 1.8; font-size: 1.05rem; }
    .article-content h2 { color: var(--primary); margin-top: 3rem; margin-bottom: 1.5rem; font-size: 1.8rem; font-weight: 700; }
    .article-content h3 { color: var(--text-main); margin-top: 2rem; font-size: 1.4rem; }
    .article-content p { margin-bottom: 1.5rem; color: #cbd5e1; }
    .article-content ul { margin-bottom: 1.5rem; padding-left: 1.5rem; }
    .article-content li { margin-bottom: 0.5rem; color: #cbd5e1; }
    .article-content pre { background: #1e293b; padding: 1.5rem; border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); margin: 2rem 0; overflow-x: auto; }
    .article-content code { font-family: 'JetBrains Mono', monospace; background: rgba(56, 189, 248, 0.1); color: var(--primary); padding: 0.2rem 0.4rem; border-radius: 4px; font-size: 0.9em; }
    .article-content pre code { background: transparent; color: inherit; padding: 0; }
    .article-content strong { color: #fff; font-weight: 700; }
    .article-content blockquote { border-left: 4px solid var(--secondary); padding-left: 1rem; margin: 1.5rem 0; color: var(--text-muted); font-style: italic; }
</style>